{% extends "base.html" %}

{% block content %}

<!-- Hero Section -->
<section class="text-center mb-12 py-12">
    <div class="space-y-6">
        <h2 class="text-5xl font-bold">H·ªá Th·ªëng Nh·∫≠n Di·ªán Vi Ph·∫°m Giao Th√¥ng</h2>
        <p class="text-xl text-gray-400">S·ª≠ d·ª•ng AI ƒë·ªÉ ph√°t hi·ªán xe vi ph·∫°m t√≠n hi·ªáu ƒë√®n ƒë·ªè t·ª± ƒë·ªông</p>
        <a href="/upload" class="inline-block bg-gradient-to-r from-red-600 to-orange-600 hover:from-red-700 hover:to-orange-700 text-white font-bold py-4 px-8 rounded-lg transition transform hover:scale-105">
            üì§ T·∫£i Video L√™n Ngay
        </a>
    </div>
</section>

<!-- Features Section -->
<section class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-12">
    <div class="bg-slate-800 border border-purple-500 rounded-lg p-6 hover:border-purple-400 transition">
        <div class="text-3xl mb-3">üé•</div>
        <h3 class="text-xl font-bold mb-3">Ph√¢n t√≠ch Video</h3>
        <p class="text-gray-400">X·ª≠ l√Ω video giao th√¥ng t·ª± ƒë·ªông b·∫±ng c√¥ng ngh·ªá AI ti√™n ti·∫øn</p>
    </div>
    
    <div class="bg-slate-800 border border-purple-500 rounded-lg p-6 hover:border-purple-400 transition">
        <div class="text-3xl mb-3">üìù</div>
        <h3 class="text-xl font-bold mb-3">Nh·∫≠n Di·ªán Bi·ªÉn S·ªë</h3>
        <p class="text-gray-400">Tr√≠ch xu·∫•t v√† x√°c ƒë·ªãnh bi·ªÉn s·ªë xe m·ªôt c√°ch ch√≠nh x√°c 99%</p>
    </div>
    
    <div class="bg-slate-800 border border-purple-500 rounded-lg p-6 hover:border-purple-400 transition">
        <div class="text-3xl mb-3">üíæ</div>
        <h3 class="text-xl font-bold mb-3">C∆° S·ªü D·ªØ Li·ªáu</h3>
        <p class="text-gray-400">L∆∞u tr·ªØ vi ph·∫°m t·∫≠p trung, d·ªÖ d√†ng qu·∫£n l√Ω v√† theo d√µi</p>
    </div>
</section>

<!-- Violations Table -->
<section id="violations" class="bg-slate-800 border border-purple-500 rounded-lg p-8">
    <h2 class="text-3xl font-bold mb-6">üìã Danh S√°ch Vi Ph·∫°m</h2>
    
    <div class="overflow-x-auto mb-6">
        <table class="w-full">
            <thead>
                <tr class="border-b-2 border-purple-500">
                    <th class="px-6 py-4 text-left font-bold text-red-400">Bi·ªÉn S·ªë Xe</th>
                    <th class="px-6 py-4 text-left font-bold text-red-400">S·ªë L·∫ßn Vi Ph·∫°m</th>
                    <th class="px-6 py-4 text-left font-bold text-red-400">L·∫ßn Cu·ªëi</th>
                </tr>
            </thead>
            <tbody id="violations-tbody">
                <tr>
                    <td colspan="3" class="px-6 py-8 text-center text-gray-400">
                        <div class="animate-spin inline-block w-6 h-6 border-2 border-purple-500 border-t-transparent rounded-full mr-3"></div>
                        ƒêang t·∫£i...
                    </td>
                </tr>
            </tbody>
        </table>
    </div>

    <button onclick="clearViolations()" class="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-6 rounded-lg transition">
        üóëÔ∏è X√≥a T·∫•t C·∫£
    </button>
</section>

<script>
    function loadViolations() {
        fetch('/violations')
            .then(r => r.json())
            .then(data => {
                const tbody = document.getElementById('violations-tbody');
                
                if (data.length === 0) {
                    tbody.innerHTML = '<tr><td colspan="3" class="px-6 py-8 text-center text-gray-400">Kh√¥ng c√≥ vi ph·∫°m</td></tr>';
                    return;
                }
                
                tbody.innerHTML = data.map(v => `
                    <tr class="border-b border-slate-700 hover:bg-slate-700 transition">
                        <td class="px-6 py-4 font-mono text-red-400 font-bold">${v.plate_number}</td>
                        <td class="px-6 py-4">
                            <span class="bg-red-900 text-red-200 px-3 py-1 rounded-full font-bold">${v.violation_count}</span>
                        </td>
                        <td class="px-6 py-4 text-gray-400 text-sm">${new Date(v.last_violation).toLocaleString('vi-VN')}</td>
                    </tr>
                `).join('');
            });
    }

    function clearViolations() {
        if (confirm('B·∫°n ch·∫Øc ch·∫Øn mu·ªën x√≥a t·∫•t c·∫£ vi ph·∫°m?')) {
            fetch('/clear-violations', {method: 'POST'})
                .then(() => {
                    alert('‚úì ƒê√£ x√≥a t·∫•t c·∫£ vi ph·∫°m');
                    loadViolations();
                });
        }
    }

    loadViolations();
    setInterval(loadViolations, 5001);
</script>

{% endblock %}